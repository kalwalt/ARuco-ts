!function(t,a){if("object"==typeof exports&&"object"==typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var e=a();for(var r in e)("object"==typeof exports?exports:t)[r]=e[r]}}(this,()=>(()=>{"use strict";var t={d:(a,e)=>{for(var r in e)t.o(e,r)&&!t.o(a,r)&&Object.defineProperty(a,r,{enumerable:!0,get:e[r]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},a={};t.r(a),t.d(a,{ARuco:()=>p,CV:()=>w,Mat3:()=>y,POS:()=>b,SVD:()=>v,VERSION:()=>x,Vec3:()=>m});class e{width;height;data;constructor(t=0,a=0,e){this.width=t,this.height=a,e instanceof Uint8ClampedArray?this.data=e:e instanceof Uint8Array||Array.isArray(e)||e instanceof ArrayBuffer?this.data=new Uint8ClampedArray(e):this.data=new Uint8ClampedArray(t*a)}static fromImageData(t){return new e(t.width,t.height,t.data)}toImageData(){const t=new ImageData(this.width,this.height);return t.data.set(this.data),t}clone(){const t=new e(this.width,this.height);return t.data.set(this.data),t}fill(t){return this.data.fill(t),this}getPixel(t,a){return this.data[a*this.width+t]}setPixel(t,a,e){this.data[a*this.width+t]=e}copy(t){return this.width=t.width,this.height=t.height,this.data=new Uint8ClampedArray(t.data),this}}class r{color;next;constructor(){this.color=0,this.next=null}}class i{static grayscale(t){const a=t.data,r=new e(t.width,t.height),i=r.data;let s=0,n=0;const o=a.length;for(;s<o;)i[n++]=.299*a[s]+.587*a[s+1]+.114*a[s+2]+.5&255,s+=4;return r}static threshold(t,a,e){const r=t.data,i=a.data,s=r.length,n=new Uint8Array(256);for(let t=0;t<256;++t)n[t]=t<=e?0:255;for(let t=0;t<s;++t)i[t]=n[r[t]];return a.width=t.width,a.height=t.height,a}static adaptiveThreshold(t,a,e,r){const s=t.data,n=a.data,o=s.length,h=new Uint8Array(768);i.stackBoxBlur(t,a,e);for(let t=0;t<768;++t)h[t]=t-255<=-r?255:0;for(let t=0;t<o;++t)n[t]=h[s[t]-n[t]+255];return a.width=t.width,a.height=t.height,a}static otsu(t){const a=t.data,e=a.length,r=new Uint32Array(256);let i=0,s=0,n=0,o=0,h=0,d=0;for(let t=0;t<e;++t)r[a[t]]++;for(let t=0;t<256;++t)s+=r[t]*t;for(let t=0;t<256;++t)if(o+=r[t],0!==o){if(h=e-o,0===h)break;n+=r[t]*t;const a=n/o-(s-n)/h,c=o*h*a*a;c>d&&(d=c,i=t)}return i}static stackBoxBlurMult=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265];static stackBoxBlurShift=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13];static stackBoxBlur(t,a,e){const s=t.data,n=a.data,o=t.height,h=t.width,d=o-1,c=h-1,l=e+e+1,u=e+1,g=i.stackBoxBlurMult[e],f=i.stackBoxBlurShift[e];let m=new r;const y=m;for(let t=1;t<l;++t)m=m.next=new r;m.next=y;let x=0;for(let t=0;t<o;++t){const t=x;let a=s[x],e=u*a;m=y;for(let t=0;t<u;++t)m.color=a,m=m.next;for(let t=1;t<u;++t)m.color=s[x+t],e+=m.color,m=m.next;m=y;for(let a=0;a<h;++a){n[x++]=e*g>>>f;let r=a+u;r=t+(r<c?r:c),e-=m.color-s[r],m.color=s[r],m=m.next}}for(let t=0;t<h;++t){x=t;let a=x+h,e=n[x],r=u*e;m=y;for(let t=0;t<u;++t)m.color=e,m=m.next;for(let t=1;t<u;++t)m.color=n[a],r+=m.color,m=m.next,a+=h;m=y;for(let a=0;a<o;++a){n[x]=r*g>>>f;let e=a+u;e=t+(e<d?e:d)*h,r-=m.color-n[e],m.color=n[e],m=m.next,x+=h}}return a}static gaussianBlur(t,a,e,r){var s=i.gaussianKernel(r);return a.width=t.width,a.height=t.height,e.width=t.width,e.height=t.height,i.gaussianBlurFilter(t,e,s,!0),i.gaussianBlurFilter(e,a,s,!1),a}static gaussianBlurFilter(t,a,e,r){const i=t.data,s=a.data,n=t.height,o=t.width;let h=0;const d=e.length>>1;for(let t=0;t<n;++t)for(let a=0;a<o;++a){let c=0;for(let s=-d;s<=d;++s){let l;r?(l=h+s,(a+s<0||a+s>=o)&&(l=h)):(l=h+s*o,(t+s<0||t+s>=n)&&(l=h)),c+=e[d+s]*i[l]}s[h++]=r?c:c+.5|0}return a}static gaussianKernel(t){let a,e,r,i,s,n,o=[];if(t<=7&&t%2==1)o=[[1],[.25,.5,.25],[.0625,.25,.375,.25,.0625],[.03125,.109375,.21875,.28125,.21875,.109375,.03125]][t>>1];else{for(a=.5*(t-1),e=.8+.3*(a-1),r=-.5/(e*e),i=0,n=0;n<t;++n)s=n-a,i+=o[n]=Math.exp(r*s*s);for(i=1/i,n=0;n<t;++n)o[n]*=i}return o}static findContours(t,a){let e,r,s,n,o,h,d,c,l,u=t.width,g=t.height,f=[];for(e=i.binaryBorder(t,a),r=i.neighborhoodDeltas(u+2),s=u+3,o=1,c=0;c<g;++c,s+=2)for(l=0;l<u;++l,++s)n=e[s],0!==n&&(h=d=!1,1===n&&0===e[s-1]?h=!0:n>=1&&0===e[s+1]&&(d=!0),(h||d)&&(++o,f.push(i.borderFollowing(e,s,o,{x:l,y:c},d,r))));return f}static borderFollowing(t,a,e,r,s,n){let o,h,d,c,l,u=[];u.hole=s,c=l=s?0:4;do{if(c=c-1&7,o=a+n[c],0!==t[o])break}while(c!==l);if(c===l)t[a]=-e,u.push({x:r.x,y:r.y});else for(h=a;;){l=c;do{d=h+n[++c]}while(0===t[d]);if(c&=7,c-1>>>0<l>>>0?t[h]=-e:1===t[h]&&(t[h]=e),u.push({x:r.x,y:r.y}),r.x+=i.neighborhood[c][0],r.y+=i.neighborhood[c][1],d===a&&h===o)break;h=d,c=c+4&7}return u}static neighborhood=[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]];static neighborhoodDeltas(t){let a=[],e=i.neighborhood.length,r=0;for(;r<e;++r)a[r]=i.neighborhood[r][0]+i.neighborhood[r][1]*t;return a.concat(a)}static approxPolyDP(t,a){let e,r,i,s,n,o,h,d,c,l,u,g={start_index:0,end_index:0},f={start_index:0,end_index:0},m=[],y=[],x=t.length;for(a*=a,u=0,c=0;c<3;++c)for(n=0,u=(u+f.start_index)%x,r=t[u],++u===x&&(u=0),l=1;l<x;++l)e=t[u],++u===x&&(u=0),h=e.x-r.x,d=e.y-r.y,s=h*h+d*d,s>n&&(n=s,f.start_index=l);for(n<=a?m.push({x:r.x,y:r.y}):(g.start_index=u,g.end_index=f.start_index+=g.start_index,f.start_index-=f.start_index>=x?x:0,f.end_index=g.start_index,f.end_index<f.start_index&&(f.end_index+=x),y.push({start_index:f.start_index,end_index:f.end_index}),y.push({start_index:g.start_index,end_index:g.end_index}));0!==y.length;){if(g=y.pop(),i=t[g.end_index%x],r=t[u=g.start_index%x],++u===x&&(u=0),g.end_index<=g.start_index+1)o=!0;else{for(n=0,h=i.x-r.x,d=i.y-r.y,c=g.start_index+1;c<g.end_index;++c)e=t[u],++u===x&&(u=0),s=Math.abs((e.y-r.y)*h-(e.x-r.x)*d),s>n&&(n=s,f.start_index=c);o=n*n<=a*(h*h+d*d)}o?m.push({x:r.x,y:r.y}):(f.end_index=g.end_index,g.end_index=f.start_index,y.push({start_index:f.start_index,end_index:f.end_index}),y.push({start_index:g.start_index,end_index:g.end_index}))}return m}static warp(t,a,e,r){const s=t.data,n=t.width,o=t.height;(a.data.length<r*r||a.width!==r||a.height!==r)&&(a.width=r,a.height=r,a.data=new Uint8ClampedArray(r*r));const h=a.data;let d=0;const c=i.getPerspectiveTransform(e,r-1);let l=c[8],u=c[2],g=c[5];for(let t=0;t<r;++t){l+=c[7],u+=c[1],g+=c[4];let t=l,a=u,e=g;for(let i=0;i<r;++i){t+=c[6],a+=c[0],e+=c[3];const r=a/t,i=e/t,l=r>>>0,u=l===n-1?l:l+1,g=r-l,f=1-g,m=i>>>0,y=i-m,x=1-y,w=m*n,p=w,v=(m===o-1?m:m+1)*n,b=v;h[d++]=x*(f*s[w+l]+g*s[p+u])+y*(f*s[v+l]+g*s[b+u])&255}}return a}static getPerspectiveTransform(t,a){let e=i.square2quad(t);return e[0]/=a,e[1]/=a,e[3]/=a,e[4]/=a,e[6]/=a,e[7]/=a,e}static square2quad(t){let a,e,r,i,s,n,o,h=[];return a=t[0].x-t[1].x+t[2].x-t[3].x,e=t[0].y-t[1].y+t[2].y-t[3].y,0===a&&0===e?(h[0]=t[1].x-t[0].x,h[1]=t[2].x-t[1].x,h[2]=t[0].x,h[3]=t[1].y-t[0].y,h[4]=t[2].y-t[1].y,h[5]=t[0].y,h[6]=0,h[7]=0,h[8]=1):(r=t[1].x-t[2].x,i=t[3].x-t[2].x,s=t[1].y-t[2].y,n=t[3].y-t[2].y,o=r*n-i*s,h[6]=(a*n-i*e)/o,h[7]=(r*e-a*s)/o,h[8]=1,h[0]=t[1].x-t[0].x+h[6]*t[1].x,h[1]=t[3].x-t[0].x+h[7]*t[3].x,h[2]=t[0].x,h[3]=t[1].y-t[0].y+h[6]*t[1].y,h[4]=t[3].y-t[0].y+h[7]*t[3].y,h[5]=t[0].y),h}static isContourConvex(t){let a,e,r,i,s,n,o,h,d=0,c=!0,l=t.length,u=0,g=0;for(e=t[l-1],a=t[0],s=a.x-e.x,n=a.y-e.y;u<l;++u){if(++g===l&&(g=0),e=a,a=t[g],o=a.x-e.x,h=a.y-e.y,r=o*n,i=h*s,d|=i>r?1:i<r?2:3,3===d){c=!1;break}s=o,n=h}return c}static perimeter(t){let a,e,r=t.length,i=0,s=r-1,n=0;for(;i<r;s=i++)a=t[i].x-t[s].x,e=t[i].y-t[s].y,n+=Math.sqrt(a*a+e*e);return n}static minEdgeLength(t){let a,e,r,i=t.length,s=0,n=i-1,o=1/0;for(;s<i;n=s++)e=t[s].x-t[n].x,r=t[s].y-t[n].y,a=e*e+r*r,a<o&&(o=a);return Math.sqrt(o)}static countNonZero(t,a){const e=t.data,r=a.height,i=a.width;let s=a.x+a.y*t.width;const n=t.width-i;let o=0;for(let t=0;t<r;++t){for(let t=0;t<i;++t)0!==e[s++]&&++o;s+=n}return o}static binaryBorder(t,a){const e=t.data,r=t.height,i=t.width;let s=0,n=0;for(let t=-2;t<i;++t)a[n++]=0;for(let t=0;t<r;++t){a[n++]=0;for(let t=0;t<i;++t)a[n++]=0===e[s++]?0:1;a[n++]=0}for(let t=-2;t<i;++t)a[n++]=0;return a}}const s="0.2.0";class n{static ARUCO={nBits:25,tau:3,codeList:[17318416,17318423,17318409,17318414,17318640,17318647,17318633,17318638,17318192,17318199,17318185,17318190,17318352,17318359,17318345,17318350,17325584,17325591,17325577,17325582,17325808,17325815,17325801,17325806,17325360,17325367,17325353,17325358,17325520,17325527,17325513,17325518,17311248,17311255,17311241,17311246,17311472,17311479,17311465,17311470,17311024,17311031,17311017,17311022,17311184,17311191,17311177,17311182,17316368,17316375,17316361,17316366,17316592,17316599,17316585,17316590,17316144,17316151,17316137,17316142,17316304,17316311,17316297,17316302,17547792,17547799,17547785,17547790,17548016,17548023,17548009,17548014,17547568,17547575,17547561,17547566,17547728,17547735,17547721,17547726,17554960,17554967,17554953,17554958,17555184,17555191,17555177,17555182,17554736,17554743,17554729,17554734,17554896,17554903,17554889,17554894,17540624,17540631,17540617,17540622,17540848,17540855,17540841,17540846,17540400,17540407,17540393,17540398,17540560,17540567,17540553,17540558,17545744,17545751,17545737,17545742,17545968,17545975,17545961,17545966,17545520,17545527,17545513,17545518,17545680,17545687,17545673,17545678,17089040,17089047,17089033,17089038,17089264,17089271,17089257,17089262,17088816,17088823,17088809,17088814,17088976,17088983,17088969,17088974,17096208,17096215,17096201,17096206,17096432,17096439,17096425,17096430,17095984,17095991,17095977,17095982,17096144,17096151,17096137,17096142,17081872,17081879,17081865,17081870,17082096,17082103,17082089,17082094,17081648,17081655,17081641,17081646,17081808,17081815,17081801,17081806,17086992,17086999,17086985,17086990,17087216,17087223,17087209,17087214,17086768,17086775,17086761,17086766,17086928,17086935,17086921,17086926,17252880,17252887,17252873,17252878,17253104,17253111,17253097,17253102,17252656,17252663,17252649,17252654,17252816,17252823,17252809,17252814,17260048,17260055,17260041,17260046,17260272,17260279,17260265,17260270,17259824,17259831,17259817,17259822,17259984,17259991,17259977,17259982,17245712,17245719,17245705,17245710,17245936,17245943,17245929,17245934,17245488,17245495,17245481,17245486,17245648,17245655,17245641,17245646,17250832,17250839,17250825,17250830,17251056,17251063,17251049,17251054,17250608,17250615,17250601,17250606,17250768,17250775,17250761,17250766,24658448,24658455,24658441,24658446,24658672,24658679,24658665,24658670,24658224,24658231,24658217,24658222,24658384,24658391,24658377,24658382,24665616,24665623,24665609,24665614,24665840,24665847,24665833,24665838,24665392,24665399,24665385,24665390,24665552,24665559,24665545,24665550,24651280,24651287,24651273,24651278,24651504,24651511,24651497,24651502,24651056,24651063,24651049,24651054,24651216,24651223,24651209,24651214,24656400,24656407,24656393,24656398,24656624,24656631,24656617,24656622,24656176,24656183,24656169,24656174,24656336,24656343,24656329,24656334,24887824,24887831,24887817,24887822,24888048,24888055,24888041,24888046,24887600,24887607,24887593,24887598,24887760,24887767,24887753,24887758,24894992,24894999,24894985,24894990,24895216,24895223,24895209,24895214,24894768,24894775,24894761,24894766,24894928,24894935,24894921,24894926,24880656,24880663,24880649,24880654,24880880,24880887,24880873,24880878,24880432,24880439,24880425,24880430,24880592,24880599,24880585,24880590,24885776,24885783,24885769,24885774,24886e3,24886007,24885993,24885998,24885552,24885559,24885545,24885550,24885712,24885719,24885705,24885710,24429072,24429079,24429065,24429070,24429296,24429303,24429289,24429294,24428848,24428855,24428841,24428846,24429008,24429015,24429001,24429006,24436240,24436247,24436233,24436238,24436464,24436471,24436457,24436462,24436016,24436023,24436009,24436014,24436176,24436183,24436169,24436174,24421904,24421911,24421897,24421902,24422128,24422135,24422121,24422126,24421680,24421687,24421673,24421678,24421840,24421847,24421833,24421838,24427024,24427031,24427017,24427022,24427248,24427255,24427241,24427246,24426800,24426807,24426793,24426798,24426960,24426967,24426953,24426958,24592912,24592919,24592905,24592910,24593136,24593143,24593129,24593134,24592688,24592695,24592681,24592686,24592848,24592855,24592841,24592846,24600080,24600087,24600073,24600078,24600304,24600311,24600297,24600302,24599856,24599863,24599849,24599854,24600016,24600023,24600009,24600014,24585744,24585751,24585737,24585742,24585968,24585975,24585961,24585966,24585520,24585527,24585513,24585518,24585680,24585687,24585673,24585678,24590864,24590871,24590857,24590862,24591088,24591095,24591081,24591086,24590640,24590647,24590633,24590638,24590800,24590807,24590793,24590798,9978384,9978391,9978377,9978382,9978608,9978615,9978601,9978606,9978160,9978167,9978153,9978158,9978320,9978327,9978313,9978318,9985552,9985559,9985545,9985550,9985776,9985783,9985769,9985774,9985328,9985335,9985321,9985326,9985488,9985495,9985481,9985486,9971216,9971223,9971209,9971214,9971440,9971447,9971433,9971438,9970992,9970999,9970985,9970990,9971152,9971159,9971145,9971150,9976336,9976343,9976329,9976334,9976560,9976567,9976553,9976558,9976112,9976119,9976105,9976110,9976272,9976279,9976265,9976270,10207760,10207767,10207753,10207758,10207984,10207991,10207977,10207982,10207536,10207543,10207529,10207534,10207696,10207703,10207689,10207694,10214928,10214935,10214921,10214926,10215152,10215159,10215145,10215150,10214704,10214711,10214697,10214702,10214864,10214871,10214857,10214862,10200592,10200599,10200585,10200590,10200816,10200823,10200809,10200814,10200368,10200375,10200361,10200366,10200528,10200535,10200521,10200526,10205712,10205719,10205705,10205710,10205936,10205943,10205929,10205934,10205488,10205495,10205481,10205486,10205648,10205655,10205641,10205646,9749008,9749015,9749001,9749006,9749232,9749239,9749225,9749230,9748784,9748791,9748777,9748782,9748944,9748951,9748937,9748942,9756176,9756183,9756169,9756174,9756400,9756407,9756393,9756398,9755952,9755959,9755945,9755950,9756112,9756119,9756105,9756110,9741840,9741847,9741833,9741838,9742064,9742071,9742057,9742062,9741616,9741623,9741609,9741614,9741776,9741783,9741769,9741774,9746960,9746967,9746953,9746958,9747184,9747191,9747177,9747182,9746736,9746743,9746729,9746734,9746896,9746903,9746889,9746894,9912848,9912855,9912841,9912846,9913072,9913079,9913065,9913070,9912624,9912631,9912617,9912622,9912784,9912791,9912777,9912782,9920016,9920023,9920009,9920014,9920240,9920247,9920233,9920238,9919792,9919799,9919785,9919790,9919952,9919959,9919945,9919950,9905680,9905687,9905673,9905678,9905904,9905911,9905897,9905902,9905456,9905463,9905449,9905454,9905616,9905623,9905609,9905614,9910800,9910807,9910793,9910798,9911024,9911031,9911017,9911022,9910576,9910583,9910569,9910574,9910736,9910743,9910729,9910734,15221264,15221271,15221257,15221262,15221488,15221495,15221481,15221486,15221040,15221047,15221033,15221038,15221200,15221207,15221193,15221198,15228432,15228439,15228425,15228430,15228656,15228663,15228649,15228654,15228208,15228215,15228201,15228206,15228368,15228375,15228361,15228366,15214096,15214103,15214089,15214094,15214320,15214327,15214313,15214318,15213872,15213879,15213865,15213870,15214032,15214039,15214025,15214030,15219216,15219223,15219209,15219214,15219440,15219447,15219433,15219438,15218992,15218999,15218985,15218990,15219152,15219159,15219145,15219150,15450640,15450647,15450633,15450638,15450864,15450871,15450857,15450862,15450416,15450423,15450409,15450414,15450576,15450583,15450569,15450574,15457808,15457815,15457801,15457806,15458032,15458039,15458025,15458030,15457584,15457591,15457577,15457582,15457744,15457751,15457737,15457742,15443472,15443479,15443465,15443470,15443696,15443703,15443689,15443694,15443248,15443255,15443241,15443246,15443408,15443415,15443401,15443406,15448592,15448599,15448585,15448590,15448816,15448823,15448809,15448814,15448368,15448375,15448361,15448366,15448528,15448535,15448521,15448526,14991888,14991895,14991881,14991886,14992112,14992119,14992105,14992110,14991664,14991671,14991657,14991662,14991824,14991831,14991817,14991822,14999056,14999063,14999049,14999054,14999280,14999287,14999273,14999278,14998832,14998839,14998825,14998830,14998992,14998999,14998985,14998990,14984720,14984727,14984713,14984718,14984944,14984951,14984937,14984942,14984496,14984503,14984489,14984494,14984656,14984663,14984649,14984654,14989840,14989847,14989833,14989838,14990064,14990071,14990057,14990062,14989616,14989623,14989609,14989614,14989776,14989783,14989769,14989774,15155728,15155735,15155721,15155726,15155952,15155959,15155945,15155950,15155504,15155511,15155497,15155502,15155664,15155671,15155657,15155662,15162896,15162903,15162889,15162894,15163120,15163127,15163113,15163118,15162672,15162679,15162665,15162670,15162832,15162839,15162825,15162830,15148560,15148567,15148553,15148558,15148784,15148791,15148777,15148782,15148336,15148343,15148329,15148334,15148496,15148503,15148489,15148494,15153680,15153687,15153673,15153678,15153904,15153911,15153897,15153902,15153456,15153463,15153449,15153454,15153616,15153623,15153609]};static ARUCO_MIP_36h12={nBits:36,tau:12,codeList:[56562524317,25770931429,4839161458,68596624564,35931143241,48420814492,29449387539,22088012831,150160643,38290206414,63018100589,7237360708,48463388455,12429895739,32398847912,10690557310,36811505649,20424594438,51348452625,59082132829,4789649285,6074601013,60833300223,17865158156,38878348407,9422290067,52530265596,1112263881,11282798128,31716556182,55939809049,65378188640,53364103696,16135388261,10585857635,18405277539,58620300626,16314326873,45976886702,36730781048,49079839777,48251450950,9367376904,46270871306,45811842918,20579384461,24858916784,45800689157,1885099856,46307169374,30966095476,37785816804,61277293828,48822885856,10217422095,64915480245,43389267094,6254111746,8290563862,37342276841,28460125290,3495333372,6758227551,7209929928,55814160128,56029470330,36738889758,18344320185,58975059075,44171881969,49170624125,3264591167,65657841412,41180650537,42494701445,36108643611,34639993860,28659990498,26930865685,15452591512,7682723690,52184653157,35325736853,15770954845,14355922747,3586151781,12705066820,36172812353,26860166751,55306861815,4458230846,52097670290,14416739556,18680720626,63503185964,21886004944,12308700311,12349350212,17960603545,41482020135,38252944768,36805791540,10164380688,9551813940,38630526064,39745661296,34997908492,4238126902,28053085457,30473796616,4054545961,43846990872,20404992582,8671648998,46543146295,35647704329,17739867588,36459700136,32297088841,21060713596,51319791578,58119572901,9474224e3,14900282644,46136470867,14594576121,19808283810,1010425331,53297363037,24692637543,26359373345,46113281484,15179644549,58533795373,4434812905,20743912811,31920827745,42332552509,64106723953,61987860015,18286833283,49956032501,13203889835,29235312165,36521555341,37903965709,11787234849,57448344684,18958239524,36489129683,17809534842,32896732754,31847577168,41236569844,33564302914,51585414251,39285898823,8882101696,42729360772,251636777,33075363724,27518016937,55852068415,7734342848,40004287547,66652317552,15292841334,14569959493,55326630930,32846929320,5603651436,25389875160,48026662697,918846935,49642306667,3924358743,57089912602,36525866802,19258047537,15798762340,29623485812,13931892113,11469315373,37306662699,61910613086,30606478781,46814571538,4917445926,4439324737,60918689504,47457428851,68021616262,18332513560,51148727658,27928255740,46173761192,40760335900,7855435272,7001299726,61833121153,43896074151,14605260403,62541610373,12393639381,37350739731,66194071346,18666749070,12382112924,1680236413,16493370640,6059486961,16751996745,21543890275,7001355285,27046496066,2804870197,8337874016,45455359079,65272880397,9060569084,60159882672,20975334688,45716885065,60604533827,8739419880,35574477989,42573002072,11905513436,39802521107,35050605614,81139249,55923865609,42972972333,38492698169,54935698999,54512761978,67740646995,41511353392,50981879100,60163858300,20282826672,49415583287,13921455465,4465851981,53900345171,59632123755,19009048020,13643781953,30188444676,20762705568]};static getDictionary(t){const a=n[t];if(a&&"object"==typeof a&&"nBits"in a&&"tau"in a&&"codeList"in a)return a;throw new Error(`The dictionary "${t}" is not recognized.`)}}class o{codes={};codeList=[];tau=0;nBits=0;markSize=0;dicName;constructor(t){this.codes={},this.codeList=[],this.tau=0,this.dicName=t,this.initialize(t)}initialize(t){this.codes={},this.codeList=[],this.tau=0,this.nBits=0,this.markSize=0,this.dicName=t;const a=n.getDictionary(t);if(!a)throw new Error('The dictionary "'+t+'" is not recognized.');this.nBits=a.nBits,this.markSize=Math.sqrt(a.nBits)+2;for(let t=0;t<a.codeList.length;t++){const e=this.parseCode(a.codeList[t],a.nBits);this.codeList.push(e),this.codes[e]={id:t}}this.tau=a.tau||this.calculateTau()}parseCode(t,a){if("number"==typeof t)return t.toString(2).padStart(a,"0");if("string"==typeof t)return parseInt(t,16).toString(2).padStart(a,"0");if(Array.isArray(t))return t.map(t=>t.toString(2).padStart(8,"0")).join("").slice(0,a);throw new Error(`Invalid code: ${t}`)}find(t){const a=t.flat().join("");let e=null;for(const t of this.codeList){const r=this.hammingDistance(a,t);r<this.tau&&(!e||r<e.distance)&&(e={id:this.codes[t].id,distance:r})}return e}_hex2bin(t,a){return t.toString(2).padStart(a,"0")}_bytes2bin(t,a){let e="";for(const r of t)e+=r.toString(2).padStart(e.length+8>a?a-e.length:8,"0");return e}hammingDistance(t,a){if(t.length!==a.length)throw new Error("Hamming distance requires inputs of the same length.");return Array.from(t).reduce((t,e,r)=>t+(e!==a[r]?1:0),0)}calculateTau(){let t=Number.MAX_VALUE;for(let a=0;a<this.codeList.length;a++)for(let e=a+1;e<this.codeList.length;e++){const r=this.hammingDistance(this.codeList[a],this.codeList[e]);t=r<t?r:t}return t}generateSVG(t){const a=this.codeList[t];if(null==a)throw new Error('The id "'+t+'" is not valid for the dictionary "'+this.dicName+'". ID must be between 0 and '+(this.codeList.length-1)+" included.");const e=this.markSize-2;let r='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '+(e+4)+" "+(e+4)+'">';r+='<rect x="0" y="0" width="'+(e+4)+'" height="'+(e+4)+'" fill="white"/>',r+='<rect x="1" y="1" width="'+(e+2)+'" height="'+(e+2)+'" fill="black"/>';for(let t=0;t<e;t++)for(let i=0;i<e;i++)"1"==a[t*e+i]&&(r+='<rect x="'+(i+2)+'" y="'+(t+2)+'" width="1" height="1" fill="white"/>');return r+="</svg>",r}}class h{id;corners;hammingDistance;constructor(t,a,e){this.id=t,this.corners=a,this.hammingDistance=e}}class d{config;dictionary;grey;thres;homography;binary;contours;polys;candidates;streamConfig;mjpeg;static mjpeg;constructor(t){console.log(`aruco-ts v${s} initialized`),this.config=t,this.binary=[],this.contours=[],this.polys=[],this.candidates=[],this.dictionary=new o(t.dictionaryName),this.dictionary.tau=null!=t.maxHammingDistance?t.maxHammingDistance:this.dictionary.tau}detectImage(t,a,e){return this.detect({width:t,height:a,data:e})}detectStreamInit(t,a,e){this.streamConfig={},this.streamConfig.width=t,this.streamConfig.height=a,this.streamConfig.imageSize=t*a*4,this.streamConfig.index=0,this.streamConfig.imageData=new Uint8ClampedArray(this.streamConfig.imageSize),this.streamConfig.callback=e||function(t,a){}}detectStream(t){for(let a=0;a<t.length;a++)if(this.streamConfig.imageData[this.streamConfig.index]=t[a],this.streamConfig.index=(this.streamConfig.index+1)%this.streamConfig.imageSize,0==this.streamConfig.index){const t={width:this.streamConfig.width,height:this.streamConfig.height,data:this.streamConfig.imageData},a=this.detect(t);this.streamConfig.callback(t,a)}}detectMJPEGStreamInit(t,a,e,r){this.mjpeg={decoderFn:r,chunks:[],SOI:[255,216],EOI:[255,217]},this.detectStreamInit(t,a,e)}detectMJPEGStream(t){const a=t.findIndex(function(t,a,e){return d.mjpeg.EOI[0]==t&&e.length>a+1&&d.mjpeg.EOI[1]==e[a+1]}),e=t.findIndex(function(t,a,e){return d.mjpeg.SOI[0]==t&&e.length>a+1&&d.mjpeg.SOI[1]==e[a+1]});if(-1===a)this.mjpeg.chunks.push(t);else{const e=t.slice(0,a+2);if(e.length&&this.mjpeg.chunks.push(e),this.mjpeg.chunks.length){const t=this.mjpeg.chunks.flat(),a=this.mjpeg.decoderFn(t);this.detectStream(a)}this.mjpeg.chunks=[]}e>-1&&(this.mjpeg.chunks=[],this.mjpeg.chunks.push(t.slice(e)))}detect(t){this.grey=i.grayscale(t),this.thres&&this.thres.width===this.grey.width&&this.thres.height===this.grey.height||(this.thres=new e(this.grey.width,this.grey.height)),i.adaptiveThreshold(this.grey,this.thres,2,7),this.contours=i.findContours(this.thres,this.binary),this.candidates=this.findCandidates(this.contours,.01*t.width,.05,10),this.candidates=this.clockwiseCorners(this.candidates);const a=Math.max(30,.05*t.width);return this.candidates=this.notTooNear(this.candidates,a),this.findMarkers(this.grey,this.candidates,49)}findCandidates(t,a,e,r){let s,n,o,h=[],d=t.length;for(this.polys=[],o=0;o<d;++o)s=t[o],s.length>=a&&(n=i.approxPolyDP(s,s.length*e),this.polys.push(n),4===n.length&&i.isContourConvex(n)&&i.minEdgeLength(n)>=r&&h.push(n));return h}clockwiseCorners(t){let a,e,r,i,s,n=t.length;for(let o=0;o<n;++o)a=t[o][1].x-t[o][0].x,r=t[o][1].y-t[o][0].y,e=t[o][2].x-t[o][0].x,i=t[o][2].y-t[o][0].y,a*i-r*e<0&&(s=t[o][1],t[o][1]=t[o][3],t[o][3]=s);return t}notTooNear(t,a){const e=[],r=t.length,s=new Array(r).fill(!1);let n,o,h;for(let e=0;e<r;++e)for(let d=e+1;d<r;++d){n=0;for(let a=0;a<4;++a)o=t[e][a].x-t[d][a].x,h=t[e][a].y-t[d][a].y,n+=o*o+h*h;n/4<a*a&&(i.perimeter(t[e])<i.perimeter(t[d])?s[e]=!0:s[d]=!0)}for(let a=0;a<r;++a)s[a]||e.push(t[a]);return e}findMarkers(t,a,r){let s,n,o=[],h=a.length;for(let d=0;d<h;++d)s=a[d],this.homography&&this.homography.width===r&&this.homography.height===r||(this.homography=new e(r,r)),i.warp(t,this.homography,s,r),i.threshold(this.homography,this.homography,i.otsu(this.homography)),n=this.getMarker(this.homography,s),n&&o.push(n);return o}getMarker(t,a){let e,r,s,n,o=this.dictionary.markSize,d=t.width/o>>>0,c=d*d>>1,l=[],u=[];for(s=0;s<o;++s)for(r=0===s||o-1===s?1:o-1,n=0;n<o;n+=r)if(e={x:n*d,y:s*d,width:d,height:d},i.countNonZero(t,e)>c)return null;for(s=0;s<o-2;++s)for(l[s]=[],n=0;n<o-2;++n)e={x:(n+1)*d,y:(s+1)*d,width:d,height:d},l[s][n]=i.countNonZero(t,e)>c?1:0;u[0]=l;let g=null,f=0;for(s=0;s<4;s++){const t=this.dictionary.find(u[s]);if(t&&(null===g||t.distance<g.distance)&&(g=t,f=s,0===g.distance))break;u[s+1]=this.rotate(u[s])}return g?new h(g.id,this.rotate2(a,4-f),g.distance):null}hammingDistance(t){let a,e,r,i,s,n=[[1,0,0,0,0],[1,0,1,1,1],[0,1,0,0,1],[0,1,1,1,0]],o=0;for(r=0;r<5;++r){for(e=1/0,i=0;i<4;++i){for(a=0,s=0;s<5;++s)a+=t[r][s]===n[i][s]?0:1;a<e&&(e=a)}o+=e}return o}mat2id(t){let a,e=0;for(a=0;a<5;++a)e<<=1,e|=t[a][1],e<<=1,e|=t[a][3];return e}rotate(t){let a=[],e=t.length;for(let r=0;r<e;++r){a[r]=[];for(let e=0;e<t[r].length;++e)a[r][e]=t[t[r].length-e-1][r]}return a}rotate2=function(t,a){let e=[],r=t.length;for(let i=0;i<r;++i)e[i]=t[(a+i)%r];return e}}class c{static svdcmp(t,a,e,r,i){let s,n,o,h,d,l,u,g,f,m,y,x,w,p,v,b=0,M=0,S=0,_=[];for(n=0;n<e;++n){if(u=n+1,_[n]=S*M,M=x=S=0,n<a){for(l=n;l<a;++l)S+=Math.abs(t[l][n]);if(0!==S){for(l=n;l<a;++l)t[l][n]/=S,x+=t[l][n]*t[l][n];for(m=t[n][n],M=-c.sign(Math.sqrt(x),m),y=m*M-x,t[n][n]=m-M,h=u;h<e;++h){for(x=0,l=n;l<a;++l)x+=t[l][n]*t[l][h];for(m=x/y,l=n;l<a;++l)t[l][h]+=m*t[l][n]}for(l=n;l<a;++l)t[l][n]*=S}}if(r[n]=S*M,M=x=S=0,n<a&&n!==e-1){for(l=u;l<e;++l)S+=Math.abs(t[n][l]);if(0!==S){for(l=u;l<e;++l)t[n][l]/=S,x+=t[n][l]*t[n][l];for(m=t[n][u],M=-c.sign(Math.sqrt(x),m),y=m*M-x,t[n][u]=m-M,l=u;l<e;++l)_[l]=t[n][l]/y;for(h=u;h<a;++h){for(x=0,l=u;l<e;++l)x+=t[h][l]*t[n][l];for(l=u;l<e;++l)t[h][l]+=x*_[l]}for(l=u;l<e;++l)t[n][l]*=S}}b=Math.max(b,Math.abs(r[n])+Math.abs(_[n]))}for(n=e-1;n>=0;--n){if(n<e-1){if(0!==M){for(h=u;h<e;++h)i[h][n]=t[n][h]/t[n][u]/M;for(h=u;h<e;++h){for(x=0,l=u;l<e;++l)x+=t[n][l]*i[l][h];for(l=u;l<e;++l)i[l][h]+=x*i[l][n]}}for(h=u;h<e;++h)i[n][h]=i[h][n]=0}i[n][n]=1,M=_[n],u=n}for(n=Math.min(e,a)-1;n>=0;--n){for(u=n+1,M=r[n],h=u;h<e;++h)t[n][h]=0;if(0!==M){for(M=1/M,h=u;h<e;++h){for(x=0,l=u;l<a;++l)x+=t[l][n]*t[l][h];for(m=x/t[n][n]*M,l=n;l<a;++l)t[l][h]+=m*t[l][n]}for(h=n;h<a;++h)t[h][n]*=M}else for(h=n;h<a;++h)t[h][n]=0;++t[n][n]}for(l=e-1;l>=0;--l)for(o=1;o<=30;++o){for(s=!0,u=l;u>=0;--u){if(g=u-1,Math.abs(_[u])+b===b){s=!1;break}if(Math.abs(r[g])+b===b)break}if(s)for(f=0,x=1,n=u;n<=l&&(m=x*_[n],Math.abs(m)+b!==b);++n)for(M=r[n],y=c.pythag(m,M),r[n]=y,y=1/y,f=M*y,x=-m*y,h=0;h<a;++h)p=t[h][g],v=t[h][n],t[h][g]=p*f+v*x,t[h][n]=v*f-p*x;if(v=r[l],u===l){if(v<0)for(r[l]=-v,h=0;h<e;++h)i[h][l]=-i[h][l];break}if(30===o)return!1;for(w=r[u],g=l-1,p=r[g],M=_[g],y=_[l],m=((p-v)*(p+v)+(M-y)*(M+y))/(2*y*p),M=c.pythag(m,1),m=((w-v)*(w+v)+y*(p/(m+c.sign(M,m))-y))/w,f=x=1,h=u;h<=g;++h){for(n=h+1,M=_[n],p=r[n],y=x*M,M*=f,v=c.pythag(m,y),_[h]=v,f=m/v,x=y/v,m=w*f+M*x,M=M*f-w*x,y=p*x,p*=f,d=0;d<e;++d)w=i[d][h],v=i[d][n],i[d][h]=w*f+v*x,i[d][n]=v*f-w*x;for(v=c.pythag(m,y),r[h]=v,0!==v&&(v=1/v,f=m*v,x=y*v),m=f*M+x*p,w=f*p-x*M,d=0;d<a;++d)p=t[d][h],v=t[d][n],t[d][h]=p*f+v*x,t[d][n]=v*f-p*x}_[u]=0,_[l]=m,r[l]=w}return!0}static pythag(t,a){let e,r=Math.abs(t),i=Math.abs(a);return r>i?(e=i/r,r*Math.sqrt(1+e*e)):0===i?0:(e=r/i,i*Math.sqrt(1+e*e))}static sign(t,a){return a>=0?Math.abs(t):-Math.abs(t)}}class l{v;constructor(t,a,e){this.v=[t||0,a||0,e||0]}copy(t){let a=this.v;const e=t.v;return a[0]=e[0],a[1]=e[1],a[2]=e[2],this}static add(t,a){const e=new l,r=e.v,i=t.v,s=a.v;return r[0]=i[0]+s[0],r[1]=i[1]+s[1],r[2]=i[2]+s[2],e}static sub(t,a){const e=new l,r=e.v,i=t.v,s=a.v;return r[0]=i[0]-s[0],r[1]=i[1]-s[1],r[2]=i[2]-s[2],e}static mult(t,a){const e=new l,r=e.v,i=t.v,s=a.v;return r[0]=i[0]*s[0],r[1]=i[1]*s[1],r[2]=i[2]*s[2],e}static addScalar(t,a){const e=new l,r=e.v,i=t.v;return r[0]=i[0]+a,r[1]=i[1]+a,r[2]=i[2]+a,e}static multScalar(t,a){const e=new l,r=e.v,i=t.v;return r[0]=i[0]*a,r[1]=i[1]*a,r[2]=i[2]*a,e}static dot(t,a){const e=t.v,r=a.v;return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}static cross(t,a){const e=t.v,r=a.v;return new l(e[1]*r[2]-e[2]*r[1],e[2]*r[0]-e[0]*r[2],e[0]*r[1]-e[1]*r[0])}normalize(){const t=this.v,a=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return a>0&&(t[0]/=a,t[1]/=a,t[2]/=a),a}static inverse(t){const a=new l,e=a.v,r=t.v;return 0!==r[0]&&(e[0]=1/r[0]),0!==r[1]&&(e[1]=1/r[1]),0!==r[2]&&(e[2]=1/r[2]),a}square(){const t=this.v;return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}minIndex(){const t=this.v;return t[0]<t[1]?t[0]<t[2]?0:2:t[1]<t[2]?1:2}}class u{m;constructor(){this.m=[[0,0,0],[0,0,0],[0,0,0]]}static clone(t){const a=new u,e=a.m,r=t.m;return e[0][0]=r[0][0],e[0][1]=r[0][1],e[0][2]=r[0][2],e[1][0]=r[1][0],e[1][1]=r[1][1],e[1][2]=r[1][2],e[2][0]=r[2][0],e[2][1]=r[2][1],e[2][2]=r[2][2],a}copy(t){const a=this.m,e=t.m;return a[0][0]=e[0][0],a[0][1]=e[0][1],a[0][2]=e[0][2],a[1][0]=e[1][0],a[1][1]=e[1][1],a[1][2]=e[1][2],a[2][0]=e[2][0],a[2][1]=e[2][1],a[2][2]=e[2][2],this}static fromRows(t,a,e){const r=new u,i=r.m,s=t.v,n=a.v,o=e.v;return i[0][0]=s[0],i[0][1]=s[1],i[0][2]=s[2],i[1][0]=n[0],i[1][1]=n[1],i[1][2]=n[2],i[2][0]=o[0],i[2][1]=o[1],i[2][2]=o[2],r}static fromDiagonal(t){const a=new u,e=a.m,r=t.v;return e[0][0]=r[0],e[1][1]=r[1],e[2][2]=r[2],a}static transpose(t){const a=new u,e=a.m,r=t.m;return e[0][0]=r[0][0],e[0][1]=r[1][0],e[0][2]=r[2][0],e[1][0]=r[0][1],e[1][1]=r[1][1],e[1][2]=r[2][1],e[2][0]=r[0][2],e[2][1]=r[1][2],e[2][2]=r[2][2],a}static mult(t,a){const e=new u,r=e.m,i=t.m,s=a.m;return r[0][0]=i[0][0]*s[0][0]+i[0][1]*s[1][0]+i[0][2]*s[2][0],r[0][1]=i[0][0]*s[0][1]+i[0][1]*s[1][1]+i[0][2]*s[2][1],r[0][2]=i[0][0]*s[0][2]+i[0][1]*s[1][2]+i[0][2]*s[2][2],r[1][0]=i[1][0]*s[0][0]+i[1][1]*s[1][0]+i[1][2]*s[2][0],r[1][1]=i[1][0]*s[0][1]+i[1][1]*s[1][1]+i[1][2]*s[2][1],r[1][2]=i[1][0]*s[0][2]+i[1][1]*s[1][2]+i[1][2]*s[2][2],r[2][0]=i[2][0]*s[0][0]+i[2][1]*s[1][0]+i[2][2]*s[2][0],r[2][1]=i[2][0]*s[0][1]+i[2][1]*s[1][1]+i[2][2]*s[2][1],r[2][2]=i[2][0]*s[0][2]+i[2][1]*s[1][2]+i[2][2]*s[2][2],e}static multVector(t,a){const e=t.m,r=a.v;return new l(e[0][0]*r[0]+e[0][1]*r[1]+e[0][2]*r[2],e[1][0]*r[0]+e[1][1]*r[1]+e[1][2]*r[2],e[2][0]*r[0]+e[2][1]*r[1]+e[2][2]*r[2])}column(t){const a=this.m;return new l(a[0][t],a[1][t],a[2][t])}row(t){const a=this.m;return new l(a[t][0],a[t][1],a[t][2])}}class g{model;focalLength;modelVectors;modelNormal;modelPseudoInverse;constructor(t,a){this.model=this.buildModel(t),this.focalLength=a,this.init()}buildModel(t){const a=t/2;return[new l(-a,a,0),new l(a,a,0),new l(a,-a,0),new l(-a,-a,0)]}init(){let t,a=new l,e=new u;this.modelVectors=u.fromRows(l.sub(this.model[1],this.model[0]),l.sub(this.model[2],this.model[0]),l.sub(this.model[3],this.model[0])),t=u.clone(this.modelVectors),c.svdcmp(t.m,3,3,a.v,e.m),this.modelPseudoInverse=u.mult(u.mult(e,u.fromDiagonal(l.inverse(a))),u.transpose(t)),this.modelNormal=e.column(a.minIndex())}pose(t){let a,e,r=new l(1,1,1),i=new u,s=new u,n=new l,o=new l;return this.pos(t,r,i,s,n,o),a=this.iterate(t,i,n),e=this.iterate(t,s,o),a<e?new f(a,i.m,n.v,e,s.m,o.v):new f(e,s.m,o.v,a,i.m,n.v)}pos(t,a,e,r,i,s){let n,o,h,d,c,g,f,m,y,x=new l(t[1].x,t[2].x,t[3].x),w=new l(t[1].y,t[2].y,t[3].y),p=l.addScalar(l.mult(x,a),-t[0].x),v=l.addScalar(l.mult(w,a),-t[0].y),b=u.multVector(this.modelPseudoInverse,p),M=u.multVector(this.modelPseudoInverse,v),S=M.square()-b.square(),_=l.dot(b,M),C=0,k=0;0===S?(C=Math.sqrt(Math.abs(2*_)),k=-Math.PI/2*(_<0?-1:_>0?1:0)):(C=Math.sqrt(Math.sqrt(S*S+4*_*_)),k=Math.atan(-2*_/S),S<0&&(k+=Math.PI),k/=2),m=C*Math.cos(k),y=C*Math.sin(k),n=l.add(b,l.multScalar(this.modelNormal,m)),o=l.add(M,l.multScalar(this.modelNormal,y)),d=n.normalize(),c=o.normalize(),h=l.cross(n,o),e.copy(u.fromRows(n,o,h)),g=(d+c)/2,f=u.multVector(e,this.model[0]),i.v=[t[0].x/g-f.v[0],t[0].y/g-f.v[1],this.focalLength/g],n=l.sub(b,l.multScalar(this.modelNormal,m)),o=l.sub(M,l.multScalar(this.modelNormal,y)),d=n.normalize(),c=o.normalize(),h=l.cross(n,o),r.copy(u.fromRows(n,o,h)),g=(d+c)/2,f=u.multVector(r,this.model[0]),s.v=[t[0].x/g-f.v[0],t[0].y/g-f.v[1],this.focalLength/g]}iterate(t,a,e){let r,i,s,n,o=1/0,h=new u,d=new u,c=new l,g=new l,f=0;for(;f<100&&(r=l.addScalar(l.multScalar(u.multVector(this.modelVectors,a.row(2)),1/e.v[2]),1),this.pos(t,r,h,d,c,g),s=this.getError(t,h,c),n=this.getError(t,d,g),s<n?(a.copy(h),e.copy(c),i=s):(a.copy(d),e.copy(g),i=n),!(i<=2||i>o));++f)o=i;return i}getError(t,a,e){let r,i,s,n,o,h,d,c,g,f=l.add(u.multVector(a,this.model[0]),e),m=l.add(u.multVector(a,this.model[1]),e),y=l.add(u.multVector(a,this.model[2]),e),x=l.add(u.multVector(a,this.model[3]),e);return r=[{x:f.v[0]*this.focalLength/f.v[2],y:f.v[1]*this.focalLength/f.v[2]},{x:m.v[0]*this.focalLength/m.v[2],y:m.v[1]*this.focalLength/m.v[2]},{x:y.v[0]*this.focalLength/y.v[2],y:y.v[1]*this.focalLength/y.v[2]},{x:x.v[0]*this.focalLength/x.v[2],y:x.v[1]*this.focalLength/x.v[2]}],i=this.angle(t[0],t[1],t[3]),s=this.angle(t[1],t[2],t[0]),n=this.angle(t[2],t[3],t[1]),o=this.angle(t[3],t[0],t[2]),h=this.angle(r[0],r[1],r[3]),d=this.angle(r[1],r[2],r[0]),c=this.angle(r[2],r[3],r[1]),g=this.angle(r[3],r[0],r[2]),(Math.abs(i-h)+Math.abs(s-d)+Math.abs(n-c)+Math.abs(o-g))/4}angle(t,a,e){const r=a.x-t.x,i=a.y-t.y,s=e.x-t.x,n=e.y-t.y;return 180*Math.acos((r*s+i*n)/(Math.sqrt(r*r+i*i)*Math.sqrt(s*s+n*n)))/Math.PI}}class f{bestError;bestRotation;bestTranslation;alternativeError;alternativeRotation;alternativeTranslation;constructor(t,a,e,r,i,s){this.bestError=t,this.bestRotation=a,this.bestTranslation=e,this.alternativeError=r,this.alternativeRotation=i,this.alternativeTranslation=s}}class m{data;constructor(t=0,a=0,e=0){this.data=new Float32Array([t,a,e])}get v(){return Array.from(this.data)}set v(t){this.data[0]=t[0]||0,this.data[1]=t[1]||0,this.data[2]=t[2]||0}get x(){return this.data[0]}set x(t){this.data[0]=t}get y(){return this.data[1]}set y(t){this.data[1]=t}get z(){return this.data[2]}set z(t){this.data[2]=t}addInPlace(t){return this.data[0]+=t.data[0],this.data[1]+=t.data[1],this.data[2]+=t.data[2],this}subInPlace(t){return this.data[0]-=t.data[0],this.data[1]-=t.data[1],this.data[2]-=t.data[2],this}multScalarInPlace(t){return this.data[0]*=t,this.data[1]*=t,this.data[2]*=t,this}normalizeInPlace(){const t=Math.sqrt(this.data[0]*this.data[0]+this.data[1]*this.data[1]+this.data[2]*this.data[2]);return t>0&&(this.data[0]/=t,this.data[1]/=t,this.data[2]/=t),t}static add(t,a,e){return e.data[0]=t.data[0]+a.data[0],e.data[1]=t.data[1]+a.data[1],e.data[2]=t.data[2]+a.data[2],e}static sub(t,a,e){return e.data[0]=t.data[0]-a.data[0],e.data[1]=t.data[1]-a.data[1],e.data[2]=t.data[2]-a.data[2],e}static mult(t,a,e){return e.data[0]=t.data[0]*a.data[0],e.data[1]=t.data[1]*a.data[1],e.data[2]=t.data[2]*a.data[2],e}static cross(t,a,e){const r=t.data[0],i=t.data[1],s=t.data[2],n=a.data[0],o=a.data[1],h=a.data[2];return e.data[0]=i*h-s*o,e.data[1]=s*n-r*h,e.data[2]=r*o-i*n,e}static multScalar(t,a,e){return e.data[0]=t.data[0]*a,e.data[1]=t.data[1]*a,e.data[2]=t.data[2]*a,e}static addScalar(t,a,e){return e.data[0]=t.data[0]+a,e.data[1]=t.data[1]+a,e.data[2]=t.data[2]+a,e}static addNew(t,a){return new m(t.data[0]+a.data[0],t.data[1]+a.data[1],t.data[2]+a.data[2])}static subNew(t,a){return new m(t.data[0]-a.data[0],t.data[1]-a.data[1],t.data[2]-a.data[2])}static multNew(t,a){return new m(t.data[0]*a.data[0],t.data[1]*a.data[1],t.data[2]*a.data[2])}static crossNew(t,a){const e=t.data[0],r=t.data[1],i=t.data[2],s=a.data[0],n=a.data[1],o=a.data[2];return new m(r*o-i*n,i*s-e*o,e*n-r*s)}static multScalarNew(t,a){return new m(t.data[0]*a,t.data[1]*a,t.data[2]*a)}static addScalarNew(t,a){return new m(t.data[0]+a,t.data[1]+a,t.data[2]+a)}copy(t){return this.data[0]=t.data[0],this.data[1]=t.data[1],this.data[2]=t.data[2],this}clone(){return new m(this.data[0],this.data[1],this.data[2])}static dot(t,a){return t.data[0]*a.data[0]+t.data[1]*a.data[1]+t.data[2]*a.data[2]}static inverse(t){const a=new m;return 0!==t.data[0]&&(a.data[0]=1/t.data[0]),0!==t.data[1]&&(a.data[1]=1/t.data[1]),0!==t.data[2]&&(a.data[2]=1/t.data[2]),a}square(){return this.data[0]*this.data[0]+this.data[1]*this.data[1]+this.data[2]*this.data[2]}minIndex(){const t=this.data;return t[0]<t[1]?t[0]<t[2]?0:2:t[1]<t[2]?1:2}normalize(){const t=Math.sqrt(this.data[0]*this.data[0]+this.data[1]*this.data[1]+this.data[2]*this.data[2]);return t>0&&(this.data[0]/=t,this.data[1]/=t,this.data[2]/=t),t}}class y{data;constructor(){this.data=new Float32Array(9)}get m(){const t=this.data;return[[t[0],t[1],t[2]],[t[3],t[4],t[5]],[t[6],t[7],t[8]]]}set m(t){this.data[0]=t[0][0],this.data[1]=t[0][1],this.data[2]=t[0][2],this.data[3]=t[1][0],this.data[4]=t[1][1],this.data[5]=t[1][2],this.data[6]=t[2][0],this.data[7]=t[2][1],this.data[8]=t[2][2]}get(t,a){return this.data[3*t+a]}set(t,a,e){this.data[3*t+a]=e}transposeInPlace(){const t=this.data;let a=t[1];return t[1]=t[3],t[3]=a,a=t[2],t[2]=t[6],t[6]=a,a=t[5],t[5]=t[7],t[7]=a,this}static mult(t,a,e){const r=t.data,i=a.data,s=e.data;return s[0]=r[0]*i[0]+r[1]*i[3]+r[2]*i[6],s[1]=r[0]*i[1]+r[1]*i[4]+r[2]*i[7],s[2]=r[0]*i[2]+r[1]*i[5]+r[2]*i[8],s[3]=r[3]*i[0]+r[4]*i[3]+r[5]*i[6],s[4]=r[3]*i[1]+r[4]*i[4]+r[5]*i[7],s[5]=r[3]*i[2]+r[4]*i[5]+r[5]*i[8],s[6]=r[6]*i[0]+r[7]*i[3]+r[8]*i[6],s[7]=r[6]*i[1]+r[7]*i[4]+r[8]*i[7],s[8]=r[6]*i[2]+r[7]*i[5]+r[8]*i[8],e}static multVector(t,a,e){const r=t.data,i=a.data,s=r[0]*i[0]+r[1]*i[1]+r[2]*i[2],n=r[3]*i[0]+r[4]*i[1]+r[5]*i[2],o=r[6]*i[0]+r[7]*i[1]+r[8]*i[2];return e.data[0]=s,e.data[1]=n,e.data[2]=o,e}static transpose(t,a){const e=t.data,r=a.data;return r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8],a}static multNew(t,a){const e=new y;return y.mult(t,a,e)}static transposeNew(t){const a=new y;return y.transpose(t,a)}static multVectorNew(t,a){const e=new m;return y.multVector(t,a,e)}static clone(t){const a=new y;return a.data.set(t.data),a}copy(t){return this.data.set(t.data),this}static fromRows(t,a,e){const r=new y,i=r.data;return i[0]=t.data[0],i[1]=t.data[1],i[2]=t.data[2],i[3]=a.data[0],i[4]=a.data[1],i[5]=a.data[2],i[6]=e.data[0],i[7]=e.data[1],i[8]=e.data[2],r}static fromDiagonal(t){const a=new y,e=a.data;return e[0]=t.data[0],e[4]=t.data[1],e[8]=t.data[2],a}static identity(){const t=new y,a=t.data;return a[0]=1,a[4]=1,a[8]=1,t}column(t){const a=this.data;return new m(a[t],a[3+t],a[6+t])}row(t){const a=this.data,e=3*t;return new m(a[e],a[e+1],a[e+2])}}const x=s;var w,p,v,b;return function(t){t.Image=e,t.grayscale=i.grayscale,t.threshold=i.threshold,t.adaptiveThreshold=i.adaptiveThreshold,t.otsu=i.otsu,t.stackBoxBlur=i.stackBoxBlur,t.gaussianBlur=i.gaussianBlur,t.findContours=i.findContours,t.approxPolyDP=i.approxPolyDP,t.warp=i.warp,t.getPerspectiveTransform=i.getPerspectiveTransform,t.isContourConvex=i.isContourConvex,t.perimeter=i.perimeter,t.minEdgeLength=i.minEdgeLength,t.countNonZero=i.countNonZero}(w||(w={})),function(t){t.Detector=d}(p||(p={})),function(t){t.svdcmp=c.svdcmp,t.pythag=c.pythag,t.sign=c.sign}(v||(v={})),function(t){t.Pose=f,t.Posit=g}(b||(b={})),a})());